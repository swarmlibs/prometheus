# yaml-language-server: $schema=https://json.schemastore.org/prometheus.json
#
# Scrape config for Docker Swarm Nodes
# 
# The Docker Engine metrics are required to be configured in the daemon.json file for Prometheus to scrape them.
# This configuration also includes a job to scrape the Node Exporter metrics that run on each node.
scrape_configs:
  - job_name: '{{.Service.Name}}-echo-scrape-config'

    static_configs:
      - targets:
          - 'localhost:9090'
        labels:
          service_id: '{{.Service.ID}}'
          service_name: '{{.Service.Name}}'
          node_id: '{{.Node.ID}}'
          node_hostname: '{{.Node.Hostname}}'
          task_id: '{{.Task.ID}}'
          task_name: '{{.Task.Name}}'
          task_slot: '{{.Task.Slot}}'
          stack_namespace: '{{ index .Service.Labels "com.docker.stack.namespace"}}'
